<Window x:Class="DockerBuildBoxSystem.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:DockerBuildBoxSystem.App"
        xmlns:vm="clr-namespace:DockerBuildBoxSystem.ViewModels.Main;assembly=DockerBuildBoxSystem.ViewModels"
        xmlns:uc="clr-namespace:DockerBuildBoxSystem.App.UserControls"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        mc:Ignorable="d"
        d:DataContext="{d:DesignInstance Type=vm:MainViewModel}"
        Title="{Binding Title}"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Menu Grid.Row="0">
            <MenuItem Header="_Sync">
                <MenuItem.Icon>
                    <materialDesign:PackIcon Kind="Flash"
                                             Foreground="{DynamicResource PrimaryHueMidBrush}"/>
                </MenuItem.Icon>

                <MenuItem Header="Sync _In..."
                  Command="{Binding SelectSourcePathCommand}">
                    <MenuItem.Icon>
                        <materialDesign:PackIcon Kind="ArrowDown"/>
                    </MenuItem.Icon>
                </MenuItem>

                <MenuItem Header="Sync _Out..."
                  Command="{Binding SelectSyncOutPathCommand}">
                    <MenuItem.Icon>
                        <materialDesign:PackIcon Kind="ArrowUp"/>
                    </MenuItem.Icon>
                </MenuItem>

                <Separator/>
                <MenuItem Header="_Force Sync"
                  Command="{Binding ElementName=ContainerConsoleControl,
                                    Path=DataContext.FileSync.StartForceSyncCommand}">
                    <MenuItem.Icon>
                        <materialDesign:PackIcon Kind="SyncAlert"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <MenuItem Header="_Container"
              ToolTip="Container options">
                <MenuItem.Icon>
                    <materialDesign:PackIcon Kind="Docker"/>
                </MenuItem.Icon>

                <MenuItem Header="_Open Container in CMD"
                  Command="{Binding ElementName=ContainerConsoleControl,
                                    Path=DataContext.ContainerList.OpenContainerInCmdCommand}">
                    <MenuItem.Icon>
                        <materialDesign:PackIcon Kind="Console"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>

            <MenuItem Header="_Settings"
              ToolTip="Settings options">
                <MenuItem.Icon>
                    <materialDesign:PackIcon Kind="Cog"/>
                </MenuItem.Icon>

                <MenuItem Header="._env"
                  Command="{Binding EnvironmentVM.OpenEnvFileCommand}"
                  ToolTip="Edit .env file">
                    <MenuItem.Icon>
                        <materialDesign:PackIcon Kind="FileEdit"/>
                    </MenuItem.Icon>
                </MenuItem>

                <MenuItem Header="syncIgnore"
                  Command="{Binding OpenSyncIgnoreFileCommand}"
                  ToolTip="Edit syncIgnore file">
                    <MenuItem.Icon>
                        <materialDesign:PackIcon Kind="FileCancel"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
        </Menu>

        <!--  Main Content Area - the UserControl is responsible for its own ViewModel lifecycle  -->
        <uc:ContainerConsole x:Name="ContainerConsoleControl" Grid.Row="1" />

        <!-- Footer with Exit Button -->
        <Grid Grid.Row="2" Margin="6">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Sync In -->
            <StackPanel Orientation="Horizontal" Grid.Row="0">
                <TextBlock Text="Sync In: "
                   FontWeight="SemiBold"/>
                <TextBlock Text="{Binding SourcePath}"
                   TextTrimming="CharacterEllipsis"
                   ToolTip="{Binding SourcePath}"
                   Foreground="Gray"/>
            </StackPanel>

            <!-- Sync Out -->
            <StackPanel Orientation="Horizontal" Grid.Row="1" Margin="0,2,0,0">
                <TextBlock Text="Sync Out: "
                   FontWeight="SemiBold"/>
                <TextBlock Text="{Binding SyncOutPath}"
                   TextTrimming="CharacterEllipsis"
                   ToolTip="{Binding SyncOutPath}"
                   Foreground="Gray"/>
            </StackPanel>
        </Grid>

        <!-- Shutdown Overlay Component -->
        <uc:ShutdownOverlay x:Name="ShutdownOverlayControl"
                            Grid.RowSpan="3"
                            Panel.ZIndex="100"
                            Visibility="Collapsed"/>
    </Grid>
</Window>
